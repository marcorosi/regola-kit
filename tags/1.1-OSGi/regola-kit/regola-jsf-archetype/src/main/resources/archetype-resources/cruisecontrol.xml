<project name="${artifactId}" buildafterfailed="false">

	<labelincrementer />

	<listeners>
		<currentbuildstatuslistener
			file="progetti/${artifactId}/logs/buildstatus.txt" />
	</listeners>

	<!-- Bootstrappers are run every time the build runs,
		*before* the modification checks -->
	<bootstrappers></bootstrappers>

	<!-- Defines where cruise looks for changes, to decide
		whether to run the build -->
	<modificationset quietperiod="60">
		<svn localworkingcopy="progetti/${artifactId}/checkout/${artifactId}" />
	</modificationset>

	<!-- Configures the actual build loop, how often and which
		build file/target -->
	<schedule interval="60">
		<maven2 mvnhome="/usr/share/maven"
			pomfile="progetti/${artifactId}/checkout/${artifactId}/pom.xml"
			goal="clean | scm:update | package" />
	</schedule>

	<!-- directory to write build logs to -->
	<log dir="progetti/${artifactId}/logs">
		<merge
			dir="progetti/${artifactId}/checkout/${artifactId}/target/surefire-reports"
			pattern="TEST-*.xml" />
	</log>

	<!-- Publishers are run *after* a build completes -->
	<publishers>
		<antpublisher
			antworkingdir="progetti/${artifactId}/checkout/${artifactId}"
			buildfile="build.xml" uselogger="true" usedebug="true"
			target="ear">
			<property name="ear.file" value="${artifactId}.ear" />
			<property name="war.file" value="${artifactId}-${version}.war" />
			<property name="target" value="target" />
			<property name="artifacts.dir" value="../../artifacts" />
		</antpublisher>
		<artifactspublisher
			file="progetti/${artifactId}/checkout/${artifactId}/target/${artifactId}-${version}.war"
			dest="progetti/${artifactId}/artifacts" />

	</publishers>
</project>
